#
# Run via up.sh
#
version: "3.7"
  

services:
  mongo:
    build: .
    image: mongo
    ports:
      - "27017"
    container_name: deadline-mongo

  deadline-slave1:
    container_name: deadline-slave1
    hostname: maya-slave1
    image: 'deadline-client-maya2019'
    volumes:
        - type: volume
          source: deadline-volume
          target: /mnt/DeadlineRepository10
        - ./share:/share
          
          
    entrypoint: ./deadlinelauncher
  
    # Expose REST API
  deadline-webservice:
    container_name: deadline-webservice
    hostname: deadline-webservice
    image: '${IMAGE}'
    ports:
      - "8082:8082"
    volumes:
      - type: volume
        source: deadline-volume
        target: /mnt/DeadlineRepository10
    entrypoint: ./deadlinewebservice

# Expose DeadlineRepository10 as a public network share
  deadline-samba:
    container_name: deadline-samba
    hostname: deadline-samba
    image: dperson/samba
    ports:
      - "139:139"
      - "445:445"
    volumes:
      - type: volume
        source: deadline-volume
        target: /share
    command: -s "DeadlineRepository10;/share;yes;no;yes;all;none;all"

#Externally created deadline volume created populated by install.sh
volumes:
  deadline-volume:
    external: true
 